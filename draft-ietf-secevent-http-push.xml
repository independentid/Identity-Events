<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type='text/xsl' href='http://xml2rfc.tools.ietf.org/authoring/rfc2629.xslt' ?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd">
<?rfc toc="yes"?>
<?rfc tocompact="yes"?>
<?rfc tocdepth="3"?>
<?rfc tocindent="yes"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes"?>
<?rfc comments="yes"?>
<?rfc inline="yes"?>
<?rfc compact="yes"?>
<?rfc subcompact="no"?>
<rfc category="std" docName="draft-ietf-secevent-http-push-04" ipr="trust200902">
    <front>
        <title abbrev="draft-ietf-secevent-http-push">Push-Based Security Event Token (SET) Delivery Using HTTP</title>

        <author fullname="Annabelle Backman" initials="A." surname="Backman" role="editor">
            <organization abbrev="Amazon">Amazon</organization>
            <address>
                <email>richanna@amazon.com</email>
            </address>
        </author>

        <author fullname="Michael B. Jones" initials="M." surname="Jones" role="editor">
            <organization abbrev="Microsoft">Microsoft</organization>
            <address>
                <email>mbj@microsoft.com</email>
                <uri>http://self-issued.info/</uri>
            </address>
        </author>

        <author fullname="Marius Scurtescu" initials="M.S." surname="Scurtescu">
            <organization abbrev="Coinbase">Coinbase</organization>
            <address>
                <email>marius.scurtescu@coinbase.com</email>
            </address>
        </author>

        <author fullname="Morteza Ansari" initials="M." surname="Ansari">
            <organization abbrev="Cisco">Cisco</organization>
            <address>
                <email>morteza.ansari@cisco.com</email>
            </address>
        </author>

        <author fullname="Anthony Nadalin" initials="A." surname="Nadalin">
            <organization abbrev="Microsoft">Microsoft</organization>
            <address>
                <email>tonynad@microsoft.com</email>
            </address>
        </author>

        <date year="2019" />
        <area>Security</area>
        <workgroup>Security Events Working Group</workgroup>
        <keyword>Internet-Draft</keyword>

        <abstract>
            <t>
                This specification defines how a Security Event Token (SET)
                may be delivered to an intended recipient using HTTP POST.
                The SET is transmitted in the body of an HTTP POST request to an
                endpoint operated by the recipient, and the recipient indicates
                successful or failed transmission via the HTTP response.
            </t>
        </abstract>
    </front>

    <middle>
        <section anchor="intro" title="Introduction and Overview" toc="default">

            <t>
                This specification defines a mechanism by which a transmitter of a
                <xref target="RFC8417">Security Event Token (SET)</xref> may deliver
                the SET to an intended recipient via <xref target="RFC7231">HTTP POST</xref>.
            </t>
            <t>
                Push-Based SET Delivery over HTTP POST is intended for scenarios where all of
                the following apply:
                <list style="symbols">
                    <t>The transmitter of the SET is capable of making outbound HTTP requests.</t>
                    <t>
                        The recipient is capable of hosting an HTTP endpoint that is accessible
                        to the transmitter.
                    </t>
                    <t>The transmitter and recipient are known to one another.</t>
                </list>
            </t>
            <t>
                A mechanism for exchanging configuration metadata such as endpoint URLs
                and cryptographic key parameters between the transmitter and receipt is
                out of scope for this specifications.
            </t>
            
            <section anchor="notat" title="Notational Conventions" toc="default">
                <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
                    NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
                    "MAY", and "OPTIONAL" in this document are to be interpreted as
                    described in BCP 14 <xref target="RFC2119"/> <xref target="RFC8174"/>
                    when, and only when, they appear in all capitals, as shown here.
                </t>

                <t>Throughout this documents all figures may contain spaces and
                    extra
                    line-wrapping for readability and due to space limitations.
                </t>
            </section>

            <section anchor="defs" title="Definitions" toc="default">
                <t>
                    This specification utilizes terminology defined in <xref target="RFC8417"/>,
                    as well as the terms defined below:
                </t>
                <t>
                    <list style="hanging">
                        <t hangText="SET Transmitter"><vspace/>
                            An entity that delivers SETs in its possession to one or more SET
                            Recipients, as defined in <xref target="RFC8417"/>.
                        </t>
                        <t hangText="SET Recipient"><vspace/>
                            An entity that receives SETs through some distribution method, as 
                            defined in <xref target="RFC8417"/>.
                        </t>
                        
                    </list>
                </t>
            </section>
        </section>

        <section title="SET Delivery">
            <t>
                To deliver a SET to a given SET Recipient, the SET Transmitter
                makes a SET Transmission Request to the SET Recipient, with the SET
                itself contained within the request. The SET Recipient replies to
                this request with a response either acknowledging successful
                transmission of the SET, or indicating that an error occurred
                while receiving, parsing, and/or validating the SET.

            </t>
            <t>
                Upon receipt of a SET, the SET Recipient SHALL validate that all of
                the following are true:
                <list style="symbols">
                    <t>The SET Recipient can parse the SET.</t>
                    <t>
                        The SET is authentic (i.e., it was issued by the issuer
                        specified within the SET).
                    </t>
                    <t>
                        The SET Recipient is identified as an intended audience of
                        the SET.
                    </t>
                    <t>
                        The SET issuer is recognized as an issuer that the SET Recipient
                        is willing to receive SETs from (e.g., the issuer is whitelisted
                        by the SET Recipient).
                    </t>
                </list>
            </t>
            <t>
                The mechanisms by which the SET Recipient performs this validation
                are out of scope for this document. SET parsing and issuer and
                audience identification are defined in <xref target="RFC8417"/>.
                The mechanism for validating the authenticity of a SET is implementation
                specific, and may vary depending on the authentication mechanisms in
                use, and whether the SET is signed and/or encrypted (See <xref target="aa"/>).
            </t>
            <t>
                The SET Recipient SHOULD ensure that the SET is persisted in a way that
                is sufficient to meet the SET Recipient's own reliability requirements,
                and MUST NOT expect or depend on a SET Transmitter to re-transmit or
                otherwise make available to the SET Recipient a SET once the SET Recipient
                acknowledges that it was received successfully.
            </t>
            <t>
                Once the SET has been validated and persisted, the SET Recipient SHOULD
                immediately return a response indicating that the SET was successfully
                delivered. The SET Recipient SHOULD NOT perform extensive business logic that
                processes the event expressed by the SET prior to sending this response.
                Such logic SHOULD be executed asynchronously from delivery, in order to
                minimize the expense and impact of SET delivery on the SET Transmitter.
            </t>
            <t>
                The SET Transmitter MAY re-transmit a SET if the responses from previous
                transmissions timed out or indicated potentially recoverable error (such
                as server unavailability that may be transient, or a decryption failure
                that may be due to misconfigured keys on the SET Recipient's side). In all
                other cases, the SET Transmitter SHOULD NOT re-transmit a SET. The SET
                Transmitter SHOULD delay retransmission for an appropriate amount of time
                to avoid overwhelming the SET Recipient (see <xref target="reliability"/>).
            </t>
            
            <section anchor="httpPost" title="Transmitting a SET">

                <t>
                    To transmit a SET to a SET Recipient, the SET Transmitter makes
                    an HTTP POST request to an HTTP endpoint provided by the SET Recipient.  The
                    <spanx style="verb">Content-Type</spanx> header of this request MUST
                    be "application/secevent+jwt" as defined in
                    Sections 2.2 and 6.2 of <xref target="RFC8417"/>, and the
                    <spanx style="verb">Accept</spanx> header MUST be "application/json".  The
                    request body MUST consist of the SET itself, represented as a
                    <xref target="RFC7519">JWT</xref>.
                </t>
                <t>
                    The SET Transmitter MAY include in the request an <spanx style="verb">Accept-Language</spanx>
                    header to indicate to the SET Recipient the preferred language(s) in which to
                    receive error messages.
                </t>
                <t>
                    The mechanisms by which the SET Transmitter determines the HTTP endpoint to
                    use when transmitting a SET to a given SET Recipient are not defined by this
                    specification and may be implementation-specific.
                </t>
                <figure align="left" anchor="postSet" title="Example SET Transmission Request">
                    <preamble>
                        The following is a non-normative example of a SET transmission request:
                    </preamble>
                    <artwork align="left">POST /Events  HTTP/1.1
Host: notify.rp.example.com
Accept: application/json
Accept-Language: en-US, en;q=0.5
Content-Type: application/secevent+jwt

eyJhbGciOiJub25lIn0
.
eyJwdWJsaXNoZXJVcmkiOiJodHRwczovL3NjaW0uZXhhbXBsZS5jb20iLCJmZWV
kVXJpcyI6WyJodHRwczovL2podWIuZXhhbXBsZS5jb20vRmVlZHMvOThkNTI0Nj
FmYTViYmM4Nzk1OTNiNzc1NCIsImh0dHBzOi8vamh1Yi5leGFtcGxlLmNvbS9GZ
WVkcy81ZDc2MDQ1MTZiMWQwODY0MWQ3Njc2ZWU3Il0sInJlc291cmNlVXJpcyI6
WyJodHRwczovL3NjaW0uZXhhbXBsZS5jb20vVXNlcnMvNDRmNjE0MmRmOTZiZDZ
hYjYxZTc1MjFkOSJdLCJldmVudFR5cGVzIjpbIkNSRUFURSJdLCJhdHRyaWJ1dG
VzIjpbImlkIiwibmFtZSIsInVzZXJOYW1lIiwicGFzc3dvcmQiLCJlbWFpbHMiX
SwidmFsdWVzIjp7ImVtYWlscyI6W3sidHlwZSI6IndvcmsiLCJ2YWx1ZSI6Impk
b2VAZXhhbXBsZS5jb20ifV0sInBhc3N3b3JkIjoibm90NHUybm8iLCJ1c2VyTmF
tZSI6Impkb2UiLCJpZCI6IjQ0ZjYxNDJkZjk2YmQ2YWI2MWU3NTIxZDkiLCJuYW
1lIjp7ImdpdmVuTmFtZSI6IkpvaG4iLCJmYW1pbHlOYW1lIjoiRG9lIn19fQ
.
c2lnbmF0dXJl</artwork>
                </figure>
            </section>

            <section anchor="successResponse" title="Success Response">
                <t>If the SET is determined to be valid, the SET Recipient SHALL
                    "acknowledge" successful transmission by responding with HTTP
                    Response Status Code 202 (Accepted) (see Section 6.3.3 of <xref target="RFC7231"/>).
		    The body of the response MUST be empty.
                </t>

                <figure anchor="goodPostResponse" title="Example Successful Delivery Response">
                    <preamble>The following is a non-normative example of a successful
                        receipt of a SET.</preamble>
                    <artwork>HTTP/1.1 202 Accepted</artwork>
                </figure>

                <t>Note that the purpose of the "acknowledgement" response is to let the
                    SET Transmitter know that a SET has been delivered and the
                    information no longer needs to be retained by the SET Transmitter.
                    Before acknowledgement, SET Recipients SHOULD ensure they have
                    validated received SETs and retained them in a manner appropriate
                    to information retention requirements appropriate to the SET
                    event types signaled. The level and method of retention of SETs
                    by SET Recipients is out of scope of this specification.</t>
            </section>
            <section anchor="failureResponse" title="Failure Response">
                <t>In the event of a general HTTP error condition, the SET Recipient
                    MAY respond with an appropriate HTTP Status Code as defined in
                    Section 6 of <xref target="RFC7231"/>.</t>
                <t>
                    When the SET Recipient detects an error parsing or
                    validating a SET transmitted in a SET Transmission Request,
                    the SET Recipient SHALL respond with an HTTP Response Status Code
                    of 400 (Bad Request).  The <spanx style="verb">Content-Type</spanx> header of this
                    response MUST be "application/json", and the body MUST be a UTF-8 encoded <xref target="RFC7159">JSON</xref>
                    object containing the following name/value pairs:
                    <list style="hanging">
                        <t hangText="err">
                            A Security Event Token Error Code (see <xref target="error_codes"/>).
                        </t>
                        <t hangText="description">
                            A UTF-8 string containing a human-readable description of the error
                            that MAY provide additional diagnostic information. The exact content
                            of this field is implementation-specific.
                        </t>
                    </list>
                </t>

                <t>
                    The response MUST include a <spanx style="verb">Content-Language</spanx> header, whose
                    value indicates the language of the error descriptions included in the response body. If
                    the SET Recipient can provide error descriptions in multiple languages, they SHOULD choose
                    the language to use according to the value of the <spanx style="verb">Accept-Language</spanx>
                    header sent by the SET Transmitter in the transmission request, as described in Section 5.3.5
                    of <xref target="RFC7231"/>. If the SET Transmitter did not send an
                    <spanx style="verb">Accept-Language</spanx> header, or if the SET Recipient does not support any
                    of the languages included in the header, the SET Recipient MUST respond with messages that are
                    understandable by an English-speaking person, as described in Section 4.5 of <xref target="RFC2277"/>.
                </t>
                    
                <figure anchor="errorResponseInvalidKey" title="Example Error Response (invalid_key)">
                    <preamble>The following is an example non-normative error response indicating
                        that the key used to encrypt the SET has been revoked.</preamble>
                    <artwork>HTTP/1.1 400 Bad Request
Content-Language: en-US
Content-Type: application/json

{
  "err": "invalid_key",
  "description": "Key ID 12345 has been revoked."
}</artwork>
                </figure>

                <figure anchor="errorResponseExpiredToken" title="Example Error Response (authentication_failed)">
                    <preamble>The following is an example non-normative error response indicating
                        that the access token included in the request is expired.</preamble>
                    <artwork>HTTP/1.1 400 Bad Request
Content-Language: en-US
Content-Type: application/json

{
  "err": "authentication_failed",
  "description": "Access token is expired."
}</artwork>
                </figure>

                <figure anchor="errorResponseBadIssuer" title="Example Error Response (access_denied)">
                    <preamble>The following is an example non-normative error response indicating
                        that the SET Transmitter is not permitted to transmit SETs issued by the
                        issuer specified in the SET.</preamble>
                    <artwork>HTTP/1.1 400 Bad Request
Content-Language: en-US
Content-Type: application/json

{
  "err": "access_denied",
  "description": "Not authorized for issuer http://iss.example.com/."
}</artwork>
                </figure>
            </section>

            <section anchor="error_codes" title="Security Event Token Delivery Error Codes">
                <t>Security Event Token Delivery Error Codes are strings that identify a
                    specific category of error that may occur when parsing or validating a SET.
                    Every Security Event Token Delivery Error Code MUST have a unique name
                    registered in the IANA "Security Event Token Delivery Error Codes"
                    registry established by <xref target="iana_set_errors"/>.</t>

                <t>The following table presents the initial set of Error Codes that are registered
                    in the IANA "Security Event Token Delivery Error Codes" registry:</t>
                <texttable anchor="reqErrors" title="SET Delivery Error Codes">
                    <ttcol>Error Code</ttcol><ttcol>Description</ttcol>
                    <c>invalid_request</c><c>The request body cannot be parsed as a SET, or the
                        event payload within the SET does not conform to the event's definition.</c>
                    <c>invalid_key</c><c>One or more keys used to encrypt or sign the SET is
                        invalid or otherwise unacceptable to the SET Recipient. (e.g., expired,
                        revoked, failed certificate validation, etc.)</c>
                    <c>authentication_failed</c><c>The SET Recipient could not authenticate the
                        SET Transmitter from the contents of the request.</c>
                    <c>access_denied</c><c>The SET Transmitter is not authorized to transmit the
                        provided SET to the SET Recipient.</c>
                </texttable>
            </section>
        </section>

        <section anchor="aa" title="Authentication and Authorization" toc="default">
            <t>The SET delivery method described in this specification is
                based upon HTTP and depends on the use of TLS and/or standard
                HTTP authentication and authorization schemes as per
                <xref target="RFC7235" />.
            </t>

            <t>Because SET Delivery describes a simple function, authorization
                for the ability to pick-up or deliver SETs can be derived by
                considering the identity of the SET issuer, or via other employed
                authentication methods.  Because SETs are
                not commands, SET Recipients are free to ignore SETs that
                are not of interest.</t>
        </section>
        <section anchor="reliability" title="Delivery Reliability" toc="default">
            <t>
                Delivery reliability requirements may vary from implementation to
                implementation.  This specification defines the response from the SET
                Recipient in such a way as to provide the SET Transmitter with the
                information necessary to determine what further action is required,
                if any, in order to meet their requirements.  SET Transmitters with
                high reliability requirements may be tempted to always retry failed
                transmissions, however it should be noted that for many types of SET
                delivery errors, a retry is extremely unlikely to be successful.  For
                example, <spanx style="verb">invalid_request</spanx> indicates a structural
                error in the content of the request body that is likely to remain when
                re-transmitting the same SET.  Others such as <spanx style="verb">access_denied</spanx>
                may be transient, for example if the SET Transmitter refreshes expired
                credentials prior to re-transmission.
            </t>
            <t>
                Implementers SHOULD evaluate their reliability requirements and the
                impact of various retry mechanisms on the performance of their systems
                to determine the correct strategy for various error conditions.
            </t>
        </section>
        <section anchor="Security" title="Security Considerations" toc="default">

            <section anchor="payloadAuthentication" title="Authentication Using Signed SETs">
                <t>In scenarios where HTTP authorization or TLS mutual authentication
                    are not used or are considered weak, JWS signed SETs SHOULD be
                    used (see <xref target="RFC7515"/> and <xref target="RFC8417">
                    Security Considerations</xref>). This enables the SET Recipient
                    to validate that the SET issuer is authorized to deliver the SET.
                </t>
            </section>

            <section title="TLS Support Considerations">
                <t>SETs may contain sensitive information that is considered PII
                    (e.g., subject claims). In such cases, SET Transmitters and
                    SET Recipients MUST require the use of a transport-layer
                    security mechanism. Event delivery endpoints MUST support TLS
                    1.2 <xref target="RFC5246"/> and MAY support additional
                    transport-layer mechanisms meeting its security requirements.
                    When using TLS, the client MUST perform a TLS/SSL server
                    certificate check, per <xref target="RFC6125"/>. Implementation
                    security considerations for TLS can be found in "Recommendations for
                    Secure Use of TLS and DTLS" <xref target="RFC7525"/>.</t>
            </section>

            <section title="Denial of Service">
                <t>
                    The SET Recipient may be vulnerable to a denial-of-service attack where a
                    malicious party makes a high volume of requests containing invalid SETs,
                    causing the endpoint to expend significant resources on cryptographic
                    operations that are bound to fail. This may be mitigated by authenticating
                    SET Transmitters with a mechanism with low runtime overhead, such as mutual
                    TLS.
                </t>
            </section>

            <section title="Authenticating Persisted SETs">
                <t>
                    At the time of receipt, the SET Recipient can rely upon transport layer
                    mechanisms, HTTP authentication methods, and/or other context from the
                    transmission request to authenticate the SET Transmitter and validate the
                    authenticity of the SET.  However, this context is typically unavailable to
                    systems that the SET Recipient forwards the SET onto, or to systems that
                    retrieve the SET from storage.  If the SET Recipient requires the ability to
                    validate SET authenticity outside of the context of the transmission request,
                    then the SET Transmitter SHOULD sign the SET in accordance with <xref target="RFC7515"/>
                    and optionally also encrypt it in accordance with <xref target="RFC7516"/>.
                </t>
            </section>
        </section>

        <section title="Privacy Considerations">
            <t>If a SET needs to be retained for audit purposes, a JWS signature MAY
                be used to provide verification of its authenticity.</t>

            <t>When sharing personally identifiable information or information
                that is otherwise considered confidential to affected users, SET
                Transmitters and Recipients MUST have the appropriate legal agreements
                and user consent or terms of service in place.</t>

            <t>The propagation of subject identifiers can be perceived as personally
                identifiable information. Where possible, SET Transmitters and Recipients
                SHOULD devise approaches that prevent propagation -- for example, the
                passing of a hash value that requires the subscriber to already know
                the subject.</t>

        </section>

        <section anchor="IANA" title="IANA Considerations">
            <section anchor="iana_set_errors" title="Security Event Token Delivery Error Codes">
                <t>
                    This document defines Security Event Token Delivery Error Codes, for which IANA
                    is asked to create and maintain a new registry titled "Security Event Token
                    Delivery Error Codes".  Initial values for the Security Event Token Delivery
                    Error Codes registry are given in <xref target="reqErrors"/>.  Future assignments
                    are to be made through the Expert Review registration policy (<xref target="RFC8126"/>)
                    and shall follow the template presented in <xref target="iana_set_errors_template"/>.
                </t>

                <section anchor="iana_set_errors_template" title="Registration Template">
                    <t>
                        <list style="hanging">
                            <t hangText="Error Code">
                                <vspace/>
                                The name of the Security Event Token Delivery Error Code, as described
                                in <xref target="error_codes"/>. The name MUST be a case-sensitive ASCII
                                string consisting only of upper-case letters ("A" - "Z"), lower-case
                                letters ("a" - "z"), and digits ("0" - "9").
                            </t>
                            <t hangText="Description">
                                <vspace/>
                                A brief human-readable description of the Security Event Token Delivery
                                Error Code.
                            </t>
                            <t hangText="Change Controller">
                                <vspace/>
                                For error codes registered by the IETF or its working groups, list "IETF
                                Secevent Working Group".  For all other error codes, list the name of the
                                party responsible for the registration.  Contact information such as
                                mailing address, email address, or phone number may also be provided.
                            </t>
                            <t hangText="Defining Document(s)">
                                <vspace/>
                                A reference to the document or documents that define the Security Event
                                Token Delivery Error Code. The definition MUST specify the name and
                                description of the error code, and explain under what circumstances the
                                error code may be used. URIs that can be used to retrieve copies of each
                                document at no cost SHOULD be included.
                            </t>
                        </list>
                    </t>
                </section>

                <section title="Initial Registry Contents">
		  <t>
		    <?rfc subcompact="yes"?>
		    <list style="hanging">
		      <t>Error Code: invalid_request</t>
                      <t>Description: The request body cannot be parsed as a SET, or the event
                          payload within the SET does not conform to the event's definition.</t>
		      <t>Change Controller: IETF Secevent Working Group</t>
		      <t>Defining Document(s): 
		      <xref target="error_codes"/> of this document
		      </t>
		    </list>
		  </t>
		  <t>
		    <list style="hanging">
                      <t>Error Code: invalid_key</t>
                      <t>Description: One or more keys used to encrypt or sign the SET is invalid
                          or otherwise unacceptable to the SET Recipient. (e.g., expired, revoked,
                          failed certificate validation, etc.)</t>
		      <t>Change Controller: IETF Secevent Working Group</t>
		      <t>Defining Document(s): 
		      <xref target="error_codes"/> of this document
		      </t>
		    </list>
		  </t>
		  <t>
		    <list style="hanging">
                      <t>Error Code: authentication_failed</t>
                      <t>Description: The SET Recipient could not authenticate the SET Transmitter
                          from the contents of the request.</t>
		      <t>Change Controller: IETF Secevent Working Group</t>
		      <t>Defining Document(s): 
		      <xref target="error_codes"/> of this document
		      </t>
		    </list>
		  </t>
		  <t>
		    <list style="hanging">
                      <t>Error Code: access_denied</t>
                      <t>Description: The SET Transmitter is not authorized to transmit the provided
                          SET to the SET Recipient.</t>
		      <t>Change Controller: IETF Secevent Working Group</t>
		      <t>Defining Document(s): 
		      <xref target="error_codes"/> of this document
		      </t>
		    </list>
		  </t>
                </section>
		<?rfc subcompact="no"?>
            </section>
        </section>
    </middle>

    <back>
        <references title="Normative References">
            <?rfc include='http://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml' ?>
            <?rfc include='http://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.5246.xml' ?><!-- TLS 1.2 -->

            <?rfc include='http://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.6125.xml' ?><!-- TLS Certs -->

            <?rfc include='http://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7159.xml' ?><!-- JSON -->

            <?rfc include='http://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7231.xml' ?><!-- HTTP Semantics -->
            <?rfc include='http://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7515.xml' ?><!-- JWS -->
            <?rfc include='http://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7516.xml' ?><!-- JWE -->
            <?rfc include='http://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7519.xml' ?><!-- JWT -->
            <?rfc include='http://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7525.xml' ?><!-- TLS Recos -->

            <?rfc include='http://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8126.xml' ?>
            <?rfc include='http://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml' ?>
            <?rfc include='http://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8417.xml'?><!-- SET -->
            <?rfc include='http://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2277.xml'?><!-- IETF Language Policy -->
        </references>

        <references title="Informative References">
            <?rfc include='http://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7235.xml' ?><!-- HTTP Auth -->
        </references>

        <section title="Other Streaming Specifications">
            <t>[[EDITORS NOTE: This section to be removed prior to publication]]</t>

            <t>The following pub/sub, queuing, streaming systems were reviewed
                as possible solutions or as input to the current draft:</t>

            <t>XMPP Events</t>
            <t>The WG considered the XMPP events ands its ability to provide a single
                messaging solution without the need for both polling and push modes.
                The feeling was the size and methodology of XMPP was to far apart from
                the current capabilities of the SECEVENTs community which focuses in
                on HTTP based service delivery and authorization.</t>

            <t>Amazon Simple Notification Service</t>
            <t>Simple Notification Service, is a pub/sub messaging product from
                AWS. SNS supports a variety of subscriber types: HTTP/HTTPS endpoints,
                AWS Lambda functions, email addresses (as JSON or plain text), phone
                numbers (via SMS), and AWS SQS standard queues. It doesn’t directly
                support pull, but subscribers can get the pull model by creating an
                SQS queue and subscribing it to the topic. Note that this puts the
                cost of pull support back onto the subscriber, just as it is in the
                push model. It is not clear that one way is strictly better than the
                other; larger, sophisticated developers may be happy to own message
                persistence so they can have their own internal delivery guarantees.
                The long tail of OIDC clients may not care about that, or may fail
                to get it right. Regardless, I think we can learn something from the
                Delivery Policies supported by SNS, as well as the delivery controls
                that SQS offers (e.g., Visibility Timeout, Dead-Letter Queues). I’m
                not suggesting that we need all of these things in the spec, but
                they give an idea of what features people have found useful.</t>
            <t>Other information:<list style="symbols">
                <t>API Reference: http://docs.aws.amazon.com/AWSSimpleQueueService/latest/APIReference/Welcome.html</t>
                <t>Visibility Timeouts: http://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-visibility-timeout.html</t>
                </list></t>

            <t>Apache Kafka</t>
            <t>Apache Kafka is an Apache open source project based upon TCP for
                distributed streaming. It prescribes some interesting general
                purpose features that seem to extend far beyond the simpler
                streaming model SECEVENTs is after. A comment from MS has been that
                Kafka does an acknowledge with poll combination event which seems
                to be a performance advantage. See: https://kafka.apache.org/intro</t>

            <t>Google Pub/Sub</t>
            <t>Google Pub Sub system favours a model whereby polling and acknowledgement
                of events is done as separate endpoints as separate functions.</t>
            <t>Information:<list style="symbols">
                <t>Cloud Overview - https://cloud.google.com/pubsub/</t>
                <t>Subscriber Overview - https://cloud.google.com/pubsub/docs/subscriber</t>
                <t>Subscriber Pull(poll) - https://cloud.google.com/pubsub/docs/pull</t>
            </list></t>
        </section>

        <section title="Acknowledgments">
            <t>The editors would like to thank the members of the SCIM working group, which
                began discussions of provisioning events starting with: draft-hunt-scim-notify-00 in 2015.</t>

            <t>The editors would like to thank Phil Hunt and the other authors of draft-ietf-secevent-delivery-02,
                on which this draft is based.</t>

            <t>The editors would like to thank the participants in the the SECEVENTS
                working group for their contributions to this specification.</t>
        </section>

        <section anchor="History" title="Change Log">
            <t>Draft 00 - AB - Based on draft-ietf-secevent-delivery-02 with the
                following changes:<list style="symbols">
                <t>Renamed to "Push-Based SET Token Delivery Using HTTP"</t>
                <t>Removed references to the HTTP Polling delivery method.</t>
                <t>Removed informative reference to RFC6202.</t>
                </list></t>
            <t>
                Draft 01 - AB:
                <list style="symbols">
                    <t>Fixed area and workgroup to match secevent.</t>
                    <t>Removed unused definitions and definitions already covered by SET.</t>
                    <t>Renamed Event Transmitter and Event Receiver to SET Transmitter and SET Receiver, respectively.</t>
                    <t>Added IANA registry for SET Delivery Error Codes.</t>
                    <t>Removed enumeration of HTTP authentication methods.</t>
                    <t>Removed generally applicable guidance for HTTP, authorization tokens, and bearer tokens.</t>
                    <t>Moved guidance for using authentication methods as DoS protection to Security Considerations.</t>
                    <t>Removed redundant instruction to use WWW-Authenticate header.</t>
                    <t>Removed further generally applicable guidance for authorization tokens.</t>
                    <t>Removed bearer token from example delivery request, and text referencing it.</t>
                    <t>Broke delivery method description into separate request/response sections.</t>
                    <t>Added missing empty line between headers and body in example request.</t>
                    <t>Removed unapplicable notes about example formatting.</t>
                    <t>Removed text about SET creation and handling.</t>
                    <t>Removed duplication in protocol description.</t>
                    <t>Added "non-normative example" text to example transmission request.</t>
                    <t>Fixed inconsistencies in use of Error Code term.</t>
                </list>
            </t>
            <t>
                Draft 02 - AB:
                <list style="symbols">
                    <t>Rewrote abstract and introduction.</t>
                    <t>Rewrote definitions for SET Transmitter, SET Receiver.</t>
                    <t>Renamed Event Delivery section to SET Delivery.</t>
                    <t>Readability edits to Success Response and Failure Response sections.</t>
                    <t>Consolidated definition of error response under Failure Response section.</t>
                    <t>Removed Event Delivery Process section and moved its content to parent section.</t>
                    <t>Readability edits to SET Delivery section and its subsections.</t>
                    <t>Added callout that SET Receiver HTTP endpoint configuration is out-of-scope.</t>
                    <t>Added callout that SET verification mechanisms are out-of-scope.</t>
                    <t>Added retry guidance, notes regarding delivery reliability requirements.</t>
                    <t>Added guidance around using JWS and/or JWE to authenticate persisted SETs.</t>
                </list>
            </t>
            <t>
	      Draft 03 - mbj:
	      <list style="symbols">
		<t>
		  Addressed problems identified in my 18-Jul-18 review message titled
		  "Issues for both the Push and Poll Specs".
		</t>
		<t>
		  Changes to align terminology with RFC 8417, for instance,
		  by using the already defined term SET Recipient rather than SET Receiver.
		</t>
		<t>
		  Applied editorial and minor normative corrections.
		</t>
		<t>
		  Updated Marius' contact information.
		</t>
	      </list>
            </t>
            <t>
                Draft 04 - AB:
                <list style="symbols">
                    <t>Replaced Error Codes with smaller set of meaningfully differentiated codes.</t>
                    <t>Added more error response examples.</t>
                    <t>Removed un-referenced normative references.</t>
                    <t>Added normative reference to JSON in error response definition.</t>
                    <t>
                        Added text clarifying that the value of the <spanx style="verb">description</spanx>
                        attribute in error responses is implementation specific.
                    </t>
                    <t>Added requirement that error descriptions and responses are UTF-8 encoded.</t>
                    <t>
                        Added error description language preferences and specification via <spanx style="verb">Accept-Language</spanx>
                        and <spanx style="verb">Content-Language</spanx> headers.
                    </t>
                    <t>Added "recognized issuer" validation requirement in section 2.</t>
                    <t>Added time outs as an acceptable reason to resend a SET in section 2.</t>
                    <t>Edited text in section 1 to clarify that configuration is out of scope.</t>
                    <t>Made minor editorial corrections.</t>
                </list>
            </t>
        </section>
    </back>
</rfc>
